<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function($scope, spUtil, $http) {
  // Call the Script Include to fetch book data
  $http.get(spUtil.getWidgetURL('book_service')).then(function(response) {
    // Update the scope with the retrieved book data
    $scope.books = response.data;
  });
}
]]></client_script>
        <controller_as>c</controller_as>
        <css>/* Box sizing rules */
*,
*::before,
*::after {
  box-sizing: border-box;
}

/* Remove default margin */
body,
h1,
h2,
h3,
h4,
p,
figure,
blockquote,
dl,
dd {
  margin: 0;
}

h2 {
  font-family: sans-serif;
  margin: 2rem 1rem;
  text-align: center;
}

.bookCarousel {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  margin-top: 1rem;
  overflow-x: auto;
  -ms-overflow-style: none; 
  scrollbar-width: none; 
  height: fit-content;
}

.book {
  padding: 1rem;
  margin: 0 1rem;
  border: 1px dashed lightgrey;
  max-width: 240px;
  display: flex;
  flex-direction: column;
  height: 100%;
  text-align: center;
}

.book &gt; * {
  padding-bottom: 8px;
}

h4 {
  font-family: sans-serif;
}

.bookAuthor {
  font-family: sans-serif;
}

.fakebookCover {
  min-width: 200px;
  height: 320px;
  background-color: lightblue;
  border: 1px dashed darkblue;
  border-radius: 5px;
  text-align: center;
  font-size: 8rem;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 8px;  
}
</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>true</has_preview>
        <id>popular_books</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {  }]]></link>
        <name>Popular books</name>
        <option_schema/>
        <public>false</public>
        <roles/>
        <script><![CDATA[var BookService = Class.create();
BookService.prototype = Object.extendsObject(AbstractAjaxProcessor, {
    getBooks: function() {
        var books = [];
        var grBooks = new GlideRecord('x_1383151_bkquest_book');
        grBooks.query();
        
        while (grBooks.next()) {
            var book = {
                title: grBooks.getValue('title'),
                author: grBooks.author.getDisplayValue(),
                coverImage: this.getBase64Image(grBooks.getValue('cover_image'))  // Assuming 'cover_image' is the field storing the image sys_id
            };
            books.push(book);
        }
        
        return books;
    },
    
    getBase64Image: function(imageSysId) {
        var grImage = new GlideRecord('image');
        if (grImage.get(imageSysId)) {
            return 'data:' + grImage.getValue('content_type') + ';base64,' + grImage.getValue('image');
        }
        return '';
    }
});
]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>harini.srija</sys_created_by>
        <sys_created_on>2024-06-02 14:02:26</sys_created_on>
        <sys_id>49a8962d93e60210ef267c5efaba10e4</sys_id>
        <sys_mod_count>12</sys_mod_count>
        <sys_name>Popular books</sys_name>
        <sys_package display_value="BookQuest" source="x_1383151_bkquest">327b26db93250210ef267c5efaba100f</sys_package>
        <sys_policy/>
        <sys_scope display_value="BookQuest">327b26db93250210ef267c5efaba100f</sys_scope>
        <sys_update_name>sp_widget_49a8962d93e60210ef267c5efaba10e4</sys_update_name>
        <sys_updated_by>harini.srija</sys_updated_by>
        <sys_updated_on>2024-06-03 05:32:38</sys_updated_on>
        <template><![CDATA[<div ng-repeat="book in books">
  <div class="book">
    <img class="bookCover" ng-src="{{book.coverImage}}" alt="{{book.title}}">
    <h4>{{book.title}}</h4>
    <p>{{book.author}}</p>
  </div>
</div>
]]></template>
    </sp_widget>
</record_update>
